function x q2tet q s q2tet convert unit quaternions to tetrahedron images x q2tet q s inputs q 4 by n matrix n unit quaternions s scalar number of pixels per side default 30 output x s by s by n array n s by s greyscale images vds 2006 jul 21 error nargchk 1 2 nargin if nargin 1 s 30 end if size q 1 4 error q must be a 4 by n matrix end if length s 1 isequal s floor s s 0 error image size must be a positive integer end n size q 2 create basic tetrahedron as four faces ti with normals ni tvert 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 qtvert local_qmult q tvert t1 qtvert 5 3 2 n1 qtvert 1 t2 qtvert 8 2 3 n2 qtvert 4 t3 qtvert 2 8 5 n3 qtvert 6 t4 qtvert 3 5 8 n4 qtvert 7 xx yy meshgrid linspace 2 2 s xx xx yy yy initialise x zeros s 2 n uint8 for a 1 n for b 1 4 p 64 8 2 b brightness of b th face eval sprintf t t d a b t tb a face xx t 1 1 yy t 2 2 xx t 1 2 yy t 2 1 & xx t 1 2 yy t 2 3 xx t 1 3 yy t 2 2 & xx t 1 3 yy t 2 1 xx t 1 1 yy t 2 3 x face a x face a p x face a p end if mod a 100 disp a end end x reshape x ss n function qt local_qmult q t qmult quaternion rotation q 4 by n t 3 by m assume m n qt 3 by m by n n size q 2 m size t 3 a q 1 b q 2 c q 3 d q 4 these rows are n by 3 row1 a 2 b 2 c 2 d 2 2 b c a d 2 b d a c row2 2 b c a d a 2 b 2 c 2 d 2 2 c d a b row3 2 b d a c 2 c d a b a 2 b 2 c 2 d 2 qt1 shiftdim row1 t 1 qt2 shiftdim row2 t 1 qt3 shiftdim row3 t 1 qt cat 1 qt1 qt2 qt3
