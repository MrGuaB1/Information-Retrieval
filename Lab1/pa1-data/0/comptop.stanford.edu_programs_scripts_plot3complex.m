function ha_out hf he hv hvx plot3complex c x f r l plot3complex c x plot3complex c x l plot3complex c x f r plot3complex c x f r l c plex object x coordinates for points in 2d or 3d l which of those points are landmarks f filtration r filtration value it is assumed that the vertices of c are labelled 1 n or 1 n where n is the number of landmarks and n is the total number of points ha hf he hv hvx returns handles to the axis faces edges vertices and original vertices for future adjustment vds 2006 jul 17 error nargchk 2 5 nargin switch nargin case 2 l 1 size x 2 f nofiltration r 0 case 3 l f f nofiltration r 0 case 4 l 1 size x 2 end if size x 1 3 x x 1 3 elseif size x 1 2 x x zeros 1 size x 2 end d size x 1 d 2 or d 3 x1 x 1 l x2 x 2 l if d 3 x3 x 3 l end held ishold if held cla end ha gca if nargout 0 ha_out ha end hf he hv hvx if dim c 0 length f 1 if held hold off end return end plot vertices v simplices c 0 if isequal f nofiltration vr v else vr v f 1 r end if size x 2 length l switch d case 2 hvx plot x 1 x 2 k case 3 hvx plot3 x 1 x 2 x 3 k end hold on end if isempty vr if held hold off end return end switch d case 2 hv plot x1 vr x2 vr r case 3 hv plot3 x1 vr x2 vr x3 vr r end hold on if dim c 1 length f 2 if held hold off end return end plot edges e simplices c 1 if isequal f nofiltration er e else er e f 2 r end if isempty er if held hold off end return end switch d case 2 he line x1 er x2 er color 0 0 0 case 3 he line x1 er x2 er x3 er color 0 0 0 end if dim c 2 length f 3 if held hold off end return end plot faces fa simplices c 2 if isequal f nofiltration fr fa else fr fa f 3 r end if isempty fr if held hold off end return end switch d case 2 hf fill x1 fr x2 fr b case 3 hf fill3 x1 fr x2 fr x3 fr b end alpha 0.1 done if held hold off end return
