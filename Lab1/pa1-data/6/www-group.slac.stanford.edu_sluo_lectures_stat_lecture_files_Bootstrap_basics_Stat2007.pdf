bootstrap basics page 1 bootstrap basics bradley efron stanford b efron and r tibshirani an introduction to the bootstrap page 2 serum measurements for 54 metastatic patients serum measurement the serum data 1 0.1 0.10 2 0.4 0.4 0.6 0.8 0.3 0.9 0.91 31.31 41.51 61.61 7 1s 1.7 1.7 _1 8 2.0 2.0 2.2 2.2 2.2 2.3 2.3 2.4 2.4 2.4 2.4 2.4 2.4 2.5 351 2.5 2.5 2.7 2.7 2.3 2.9 2.9 2.9 3.0 3.1 3.1 3.2 3.2 3.3 3.3 3.5 4.4 52 4.5 6.4 9.4 page 3 a famous formula data a 1 $2 z 3 xn n i 54 mean 9 3 512 n estimates the expected value of a rgridom ce 2.32 famous formula sterr 5 2 n2 i 206 says how well 5 estimates the true expectation confidence interval at 1.96 sterr the catch no famous formulas for median correlation b oot st rap a computer based way of estimating standard errors biases confidence intervals for any statistic page 4 bootstrap resampling given the data x a bootstrap sample is a random sample of size n taken with replacement from x boo ts trap replica tion of statistic 5 i s x is bootstrap estimate of standard error is the observed standard deviation of repeated bootstrap replications reference chapter 6 of an introduction to the bootstrap b efron and r tibshirani chapman & hall 1993 page 5 page 6 figure 6.1 the bootstrap algorithm for estimating the standard error of a statistic d i s x each bootstrap sample is an independent random sample of size n from f the number of bootstrap replications b for estimating a standard error is usually between 25 and 200 as b 00 5735 approaches the plug in estimate of sep 6l bootstrap b t ap bootstrap estimate empmca samples of replieations of standard error distribution size h qf 9 i v i l o s x 2 b 2 s x 2 3 i e 3 s x 3 a 3 f l b x 6 b s x b a word about notation in 6.7 we write se1 bi rather than sef 6l to avoid confusion between ti the value of s x based on the observed data and d s x thought of as a random variable based on the bootstrap sample the fuller notation sel5 x em phasizes that sef is a bootstrap standard error the actual data x is held fixed in 6.7 the randomness in the calculation comes from the variability of the bootstrap samples x given x similarly we will write e fg x to indicate the bootstrap ezrpectation of a func of wl pie 1.01 nil lai 15 4151 il 3 wl 1 h in st 6 w vs of sa lo ill page 7 bootstrap program in splus function x b stat bootstrap stat x b times x is nxp matrix of data can be a vector x as matrix x n nrow x ss rep o b choosing the bootstrap samples 1 sample lzn i1 b replace t i matrix i n doing the bootstrap replications for b in l b xx x i b ss b __stat xx ss page 8 page 9 fig1 kidney data 157 normal volunteers 0ess t0t age span 5 8 9 o2 cozuci meuv_ 22 80 60 40 20 age page 10 mum om ow 3 om mom 8 8 3 om 170 uens 1ooq 101 page 11 fig3 100 bootrepsz fhat 31 fhat 26 difference page 12 bootstrap confidence intervals 0 approximate 1 2a bca interval requires 2 preliminary calculations bias constant 40 i _1 proportion s 49 standard normal edf acceleration zl 91 w 1 i 1 ca _ _ 1 2 6 z o w2 1 gm i t 5131 $2 55 51 1 z 1 1 bc 1 interval is 041 12 quantiles of boot histogram z101 0&1 i i z9 l efron & tibshirani chapter 14 page 13 favorable properties standard interval 51 5z has non coverage probabilities 0 j 0 1 5 in each tail bca interval oz t o 1 n transformation invariance if q5 111 9 monotone transformation bcam i b b a 9 page 14 2000 bootstrap reps of age 31 age 26 fitted values kndney data and the bca 95 confidence l m ts om 00 om _ 8 3 om difference values thetahat 118 z0 01 13 a 008 page 15 more general data structures 91 real world bootstrap world unknown probability estimated bootstrap model observed data probability sample model a p 1 x x1 x2 xn l statistic of interest bootstrap replication figure 8.3 schematic diagram of the bootstrap applied to problems with a general data structure p x the crucial step produces an estimate p of the entire probability mechanism p from the observed data x the rest of the bootstrap picture is determined by the real world p x is the same as p x the mapping from x 9 s x is the same as the mapping from x ti s x 7 arrow in specific applications we need to define the arrow more carefully as in 8.5 for the two sample problem the data set x may no longer be a single vector it has a form dependent on the data structure for example x z y in the two sample problem having observed x we calculate a statistic of interest 63 from x according to the function the bootstrap side of figure 8.3 is defined by the analogous
