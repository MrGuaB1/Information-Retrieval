copy c computer science 50 problem set 5 copies a bmp piece by piece just because include stdio h include stdlib h include bmp h int main int argc char argv ensure proper usage if argc 3 printf usage copy infile outfile n return 1 remember filenames char infile argv 1 char outfile argv 2 open input file file inptr fopen infile r if inptr null printf could not open s n infile return 2 open output file file outptr fopen outfile w if outptr null fclose inptr fprintf stderr could not create s n outfile return 3 read infile's bitmapfileheader bitmapfileheader bf fread &bf sizeof bitmapfileheader 1 inptr read infile's bitmapinfoheader bitmapinfoheader bi fread &bi sizeof bitmapinfoheader 1 inptr ensure infile is likely a 24 bit uncompressed bmp 4.0 if bf bftype 0x4d42 bf bfoffbits 54 bi bisize 40 bi bibitcount 24 bi bicompression 0 fclose outptr fclose inptr fprintf stderr unsupported file format n return 4 write outfile's bitmapfileheader fwrite &bf sizeof bitmapfileheader 1 outptr write outfile's bitmapinfoheader fwrite &bi sizeof bitmapinfoheader 1 outptr determine padding for scanlines int padding 4 bi biwidth sizeof rgbtriple 4 4 iterate over infile's scanlines for int i 0 biheight abs bi biheight i biheight i++ iterate over pixels in scanline for int j 0 j bi biwidth j++ temporary storage rgbtriple triple read rgb triple from infile fread &triple sizeof rgbtriple 1 inptr write rgb triple to outfile fwrite &triple sizeof rgbtriple 1 outptr skip over padding if any fseek inptr padding seek_cur write padding to outfile for int k 0 k padding k++ fputc 0x00 outptr close infile fclose inptr close outfile fclose outptr that's all folks return 0
