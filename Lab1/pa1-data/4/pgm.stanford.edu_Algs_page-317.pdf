9.5 conditioning 317 algorithm 9.5 conditioning algorithm procedure sum product conditioning y u 1 for each u page 1 9.5 conditioning 317 algorithm 9.5 conditioning algorithm procedure sum product conditioning  set of factors possibly reduced by evidence y set of query variables u set of variables on which to condition 1 for each u val u 2 u  u u   3 construct hu 4 u u y cond prob ve hu y 5  y u u y u u 6 return  y the conditioning algorithm is based on the following simple derivation let u x be any set of variables then we have that p y u val u p y u 9.11 the key observation is that each term p y u can be computed by marginalizing out the variables in x u y in the unnormalized measure p u obtained by reducing p to the context u as we have already discussed the reduced measure is simply the measure defined by reducing each of the factors to the context u the reduction process generally produces a simpler structure with a reduced inference cost we can use this formula to compute p y as follows we construct a network h u for each assignment u these networks have identical structures but different parameters we run sum product inference in each of them to obtain a factor over the desired query set y we then simply add up these factors to obtain p y we can also derive p y by renormalizing this factor to obtain a distribution as usual the normalizing constant is the partition function for p however applying equation 9.11 to the case of y we conclude that z u z u thus we can derive the overall partition function from the partition functions for the different subnetworks h u the final algorithm is shown in algorithm 9.5 we note that cond prob ve was called without evidence since we assumed for simplicity that our factors  have already been reduced with the evidence
