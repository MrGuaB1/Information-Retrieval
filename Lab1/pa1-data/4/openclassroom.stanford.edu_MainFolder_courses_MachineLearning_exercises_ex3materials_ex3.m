exercise 3 multivariate linear regression clear all close all clc x load ex3x dat y load ex3y dat m length y add intercept term to x x ones m 1 x save a copy of the unscaled features for later x_unscaled x scale features and set them to zero mean mu mean x sigma std x x 2 x 2 mu 2 sigma 2 x 3 x 3 mu 3 sigma 3 prepare for plotting figure plot each alpha's data points in a different style braces indicate a cell not just a regular array plotstyle b r g k b r gradient descent alpha 0.01 0.03 0.1 0.3 1 1.3 max_itr 100 this will contain my final values of theta after i ve found the best learning rate theta_grad_descent zeros size x 1 for i 1 length alpha theta zeros size x 1 initialize fitting parameters j zeros max_itr 1 for num_iterations 1 max_itr calculate the j term j num_iterations 0.5 m x theta y x theta y the gradient grad 1 m x x theta y here is the actual update theta theta alpha i grad end now plot the first 50 j terms plot 0 49 j 1 50 char plotstyle i linewidth 2 hold on after some trial and error i find alpha 1 is the best learning rate and converges before the 100th iteration so i save the theta for alpha 1 as the result of gradient descent if alpha i 1 theta_grad_descent theta end end legend 0.01 0.03 0.1 0.3 1 1.3 xlabel number of iterations ylabel cost j force matlab to display more than 4 decimal places formatting persists for rest of this session format long display gradient descent's result theta_grad_descent estimate the price of a 1650 sq ft 3 br house price_grad_desc dot theta_grad_descent 1 1650 mu 2 sigma 2 3 mu 3 sigma 3 calculate the parameters from the normal equation theta_normal x_unscaled x_unscaled x_unscaled y estimate the house price again price_normal dot theta_normal 1 1650 3
