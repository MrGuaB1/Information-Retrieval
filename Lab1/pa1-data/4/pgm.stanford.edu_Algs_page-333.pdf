9.6 inference with structured cpds 333 algorithm 9.7 sum product variable elimination for sets of rules procedure rule sum page 1 9.6 inference with structured cpds 333 algorithm 9.7 sum product variable elimination for sets of rules procedure rule sum product eliminate var r set of rules y variable to be eliminated 1 r+  r scope  y 2 r r r+ 3 while r+ 4 apply one of the following actions when applicable 5 rule sum 6 select rc r+ such that 7 rc c y y1 p1 c y yk pk 8 no other  r+ is compatible with c 9 r r y rc 10 r+ r+ rc 11 rule product 12 select c p1 c p2 r+ 13 r+ r+ c p1 c p2 c p1 p2 14 rule splitting for rule product 15 select 1 2 r+ such that 16 1 c1 p1 17 2 c2 p2 18 c1 c2 19 r+ r+ 1 2 rule split 1 c2 rule split 2 c1 20 rule splitting for rule sum 21 select 1 2 r+ such that 22 1 c1 y yi p1 23 2 c2 y yj p2 24 c1 c2 25 i j 26 r+ r+ 1 2 rule split 1 c2 rule split 2 c1 27 return r a different way of understanding the algorithm is to consider its application to rule sets that originate from standard table cpds it is not difficult to verify that the algorithm performs exactly the same set of operations as standard variable elimination for example the standard operation of factor product is simply the application of rule splitting on all of the rules that constitute the two tables followed by a sequence of rule product operations on the resulting rule pairs see exercise 9.16 to prove that the algorithm computes the correct result we need to show that each operation performed in the context of the algorithm maintains a certain correctness invariant let r be the current set of rules maintained by the algorithm and w be the variables that have not yet been eliminated each operation must maintain the following condition
