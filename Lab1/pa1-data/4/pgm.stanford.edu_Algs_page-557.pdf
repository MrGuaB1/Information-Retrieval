13.2 variable elimination for marginal map 557 algorithm 13.1 variable elimination algorithm for map the algorithm can be us page 1 13.2 variable elimination for marginal map 557 algorithm 13.1 variable elimination algorithm for map the algorithm can be used both in its max product form as shown or in its max sum form replacing factor product with factor addition procedure max product ve  set of factors over x ordering on x 1 let x1 xk be an ordering of x such that 2 xi xj iff i j 3 for i 1 k 4  xi max product eliminate var  xi 5 x traceback map xi i 1 k 6 return x   contains the probability of the map procedure max product eliminate var  set of factors z variable to be eliminated 1    z scope  2    3  n   4  maxz  5 return    procedure traceback map xi i 1 k 1 for i k 1 2 ui x i 1 x k scope xi xi 3 the maximizing assignment to the variables eliminated after xi 4 x i arg maxxi xi xi ui 5 x i is chosen so as to maximize the corresponding entry in the factor relative to the previous choices ui 6 return x as we have discussed the result of the computation is a max marginal maxmarg p xi over the final uneliminated variable xi we can now choose the maximizing value x i for xi importantly from the definition of max marginals we are guaranteed that there exists some assignment  consistent with x i but how do we construct such an assignment we return once again to our simple example example 13.3 consider the network of example 13.1 but now assume that we wish to find the actual assignment a b arg maxa b p a b as we discussed we first compute the internal maximization
