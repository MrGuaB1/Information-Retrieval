fig_08_22 plot polar stress components near the half circular valley under lithostatic stress loading michell 1899 equation 8.90 clear all clf reset clear memory and figures rad 1000 valley radius m rhog 0.025 weight per unit volume mpa m x linspace 0 5000 100 eps add eps to avoid singularity at origin y linspace 0 5000 100 x y meshgrid x y define cartesian grid th r cart2pol x y convert to polar coordinates srrv rhog r sin th rad r 2 stress due to valley srrv find r rad nan avoid grid points within valley srr rhog r sin th 1 rad r 2 add lithostatice stress stt rhog r sin th srr find r rad nan stt find r rad nan figure surf x y srrv xlabel x axis ylabel y axis zlabel stress srrv figure surf x y srr xlabel x axis ylabel y axis zlabel stress srr figure surf x y stt xlabel x axis ylabel y axis zlabel stress stt plot filled contour maps of stresses contourf x y srrv 10 colorbar axis equal axis tight title stress srr valley figure contourf x y srr 10 colorbar axis equal axis tight title stress srr s1 figure contourf x y stt 10 colorbar axis equal axis tight title stress stt s2 cartesian components sth sin th sth2 sth 2 cth cos th cth2 cth 2 sxx srr cth2 stt sth2 syy srr sth2 stt cth2 sxy srr stt cth sth figure subplot 2 2 1 contourf x y sxx 10 colorbar title stress sxx subplot 2 2 3 contourf x y syy 10 colorbar title stress syy subplot 2 2 4 contourf x y sxy 10 colorbar title stress sxy s1 0.5 sxx syy sqrt 0.25 sxx syy 2 sxy 2 s2 0.5 sxx syy sqrt 0.25 sxx syy 2 sxy 2 figure subplot 2 2 3 contourf x y s1 10 colorbar title stress s1 subplot 2 2 4 contourf x y s2 10 colorbar title stress s2 g1 0.5 atan2 2 sxy sxx syy g1 find r rad nan u cos g1 v sin g1 figure quiver x y u v 4 axis equal
