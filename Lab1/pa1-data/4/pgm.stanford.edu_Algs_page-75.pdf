3.3 independencies in graphs 75 algorithm 3.1 algorithm for finding nodes reachable from x given z via active trails procedure page 1 3.3 independencies in graphs 75 algorithm 3.1 algorithm for finding nodes reachable from x given z via active trails procedure reachable g bayesian network graph x source variable z observations 1 phase i insert all ancestors of z into a 2 l z nodes to be visited 3 a ancestors of z 4 while l 5 select some y from l 6 l l y 7 if y a then 8 l l pay y s parents need to be visited 9 a a y y is ancestor of evidence 10 11 phase ii traverse active trails starting from x 12 l x node direction to be visited 13 v node direction marked as visited 14 r nodes reachable via active trail 15 while l 16 select some y d from l 17 l l y d 18 if y d v then 19 if y z then 20 r r y y is reachable 21 v v y d mark y d as visited 22 if d and y z then trail up through y active if y not in z 23 for each z pay 24 l l z y s parents to be visited from bottom 25 for each z chy 26 l l z y s children to be visited from top 27 else if d then trails down through y 28 if y z then 29 downward trails to y s children are active 30 for each z chy 31 l l z y s children to be visited from top 32 if y a then v structure trails are active 33 for each z pay 34 l l z y s parents to be visited from bottom 35 return r
