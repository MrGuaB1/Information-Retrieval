exercise 5 regularized logistic regression clear all close all clc x load ex5logx dat y load ex5logy dat plot the training data use different markers for positives and negatives figure pos find y neg find y 0 plot x pos 1 x pos 2 k+ linewidth 2 markersize 7 hold on plot x neg 1 x neg 2 ko markerfacecolor y markersize 7 add polynomial features to x by calling the feature mapping function provided in separate m file x map_feature x 1 x 2 m n size x initialize fitting parameters theta zeros n 1 define the sigmoid function g inline 1.0 1.0 exp z setup for newton's method max_itr 15 j zeros max_itr 1 lambda is the regularization parameter lambda 0 newton's method for i 1 max_itr calculate the hypothesis function z x theta h g z calculate j for testing convergence j i 1 m sum y log h 1 y log 1 h lambda 2 m norm theta 2 end 2 calculate gradient and hessian g lambda m theta g 1 0 extra term for gradient l lambda m eye n l 1 0 extra term for hessian grad 1 m x hy g h 1 m x diag h diag 1 h x l here is the actual update theta theta h grad end show j to determine if algorithm has converged j display the norm of our parameters norm_theta norm theta plot the results we will evaluate theta x over a grid of features and plot the contour where theta x equals zero here is the grid range u linspace 1 1.5 200 v linspace 1 1.5 200 z zeros length u length v evaluate z theta x over the grid for i 1 length u for j 1 length v z i j map_feature u i v j theta end end z z important to transpose z before calling contour plot z 0 notice you need to specify the range 0 0 contour u v z 0 0 linewidth 2 legend y 1 y 0 decision boundary title sprintf lambda g lambda fontsize 14 hold off uncomment to plot j figure plot 0 max_itr 1 j o markerfacecolor r markersize 8 xlabel iteration ylabel j
