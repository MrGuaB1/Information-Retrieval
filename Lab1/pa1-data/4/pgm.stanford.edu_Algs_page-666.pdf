666 chapter 15 inference in temporal models algorithm 15.2 likelihood weighted particle generation for a 2 tbn procedure lw 2tb page 1 666 chapter 15 inference in temporal models algorithm 15.2 likelihood weighted particle generation for a 2 tbn procedure lw 2tbn b 2 tbn  instantiation to time t 1 variables o t o t time t evidence 1 let x 1 x n be a topological ordering of x in b 2 w 1 3 for i 1 n 4 ui  x pax i 5 assignment to pax i in x1 xn x 1 x i 1 6 if x i o t then 7 sample x i from p x i ui 8 else 9 x i o t x i assignment to x i in o t 10 w w p x i ui multiply weight by probability of desired value 11 return x 1 x n w algorithm 15.3 likelihood weighting for filtering in dbns procedure lw dbn b0 b dbn m number of samples o 1 o 2 observation sequence 1 for m 1 m 2 sample  0 m from b0 3 w m 1 4 for t 1 2 5 for m 1 m 6  t m w lw 2tbn b  t 1 m o t 7 sample time t variables starting from time t 1 sample 8 w m w m w 9 multiply weight of m th sample with weight of time t evi dence 10  t  m m 1 w m 11  t m  m m 1 w m
