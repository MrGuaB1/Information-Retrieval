13.6 using graph cuts for map 591 algorithm 13.4 graph cut algorithm for map in pairwise binary mrfs with submodular potentials page 1 13.6 using graph cuts for map 591 algorithm 13.4 graph cut algorithm for map in pairwise binary mrfs with submodular potentials procedure mincut map o singleton and pairwise submodular energy factors 1 define the energy function 2 for all i 3 o i oi 4 initialize o i j to 0 for all i j 5 for all pairs i j 6 o i 1 o i 1 oi j 1 0 oi j 0 0 7 o j 1 o j 1 oi j 1 1 oi j 1 0 8 o i j 0 1 oi j 1 0 oi j 0 1 oi j 0 0 oi j 1 1 9 10 construct the graph 11 for all i 12 if o i 1 o i 0 then 13 e e s zi 14 cost s zi o i 1 o i 0 15 else 16 e e zi t 17 cost zi t o i 0 o i 1 18 for all pairs i j such that o i j 0 1 0 19 e e zi zj 20 cost zi zj o i j 0 1 21 22 t mincut z1 zn e 23 mincut returns ti 1 iff zi zt 24 return t because of submodularity this term satisfies o i j 0 1 0 the algorithm executes this trans formation for every pairwise potential i j the resulting energy function can easily be converted into a graph using essentially the same construction that we used earlier the only slight dif ference is that for our new energy function o i j vi vj we need to introduce only the edge zi zj with cost o i j 0 1 we do not introduce the opposite edge zj zi we now use the same mapping between st cuts in the graph and assignment to the variables x1 xn it is not difficult to verify that the cost of an st cut c in the resulting graph is precisely e c const see exercise 13.14 thus finding the minimum cut in this graph directly gives us the cost minimizing assignment map note that for pairwise submodular energy there is an lp relaxation of the map integer optimization which is tight thus this result provides another example where having a tight lp relaxation allows us to find the optimal map assignment
