apache security notes apache security notes fixing problems reported by the security scan there are two 2 separate independent vulnerabilites that the security scan looks for in apache servers either or both may be reported for your server here are some notes on how to fix them 1 apacheservertokennotset this one is relatively easy to fix open your apache config file normally httpd conf look for a line that says something like servertokens full if you find one or more change it them to servertokens productonly productonly can be abbreviated prod if you don t find one add that line servertokens prod it can go anywhere in section 1 global environment or section 2 main server configuration typically it is near the end of section 1 or the beginning of section 2 it is also recommended that you add a second line serversignature off although our scans don t check for that make sure there isn t a second servertoken or serversignature line further down your config file a later directive will override the earlier one after editing and saving your config file you need to stop and restart apache to have the change take effect 2 httptraceenabled fixing this one is often straightforward but can be more complicated if your webserver is running the tomcat java servlet container as for example some elog installations do be sure to see the final section if you think you have fixed apache but still have trace enabled on port 8080 again check the tomcat notes below update for apache version 1.3 34 or later 1.3 x versions or apache 2.0 55 or later this has been made easy in section 1 just add the line traceenable off for older versions of apache see below first you have to make sure you have the apache module mod_rewrite available look for a line like loadmodule rewrite_module libexec mod_rewrite so and or addmodule mod_rewrite c if there is no such line you will need to add one but first you will need to determine if either the static module is built in to your apache or if the dynamic module is available for loading if neither is available you will have to add one or the other this can mean recompiling apache this is outside the scope of these notes consult with whomever installed apache for you once you know that mod_rewrite is available you need to add this block of lines block access slac addition rewriteengine on rewritecond request_method trace track rewriterule f end block access rule to the main server config section 2 and to each and every virtual host defined in your config or if you have the block in the main host config you can just add the following to the virtual host s config s rewriteoptions inherit if you don t have any virtual hosts then you only need it in the main server config if you are using ssl you most likely have a virtual host defined for that and will need it there note if you are running apache 2 there is often an ssl virtual host defined by default in a separate file conf d ssl conf you ll need to add the lines there too or get rid of the virtual host if you don t need it security will normally tell you which port s the problem is on port 443 will indicate it is an ssl host for the curious the first and last lines are just comments the second line insures that the rewrite module is on the next line says that any trace or track request should be rewritten the fourth line says that what the request should get instead of a trace track is the forbidden error page again after saving your modified config file s you need to stop and start apache disabling trace in tomcat if you are running tomcat as part of your installation you may also get a report about trace enabled on port 8080 or similar port here is one example of how to fix this for tomcat 4.0 look in your server xml file for a entry with the matching port number for example connector classname org apache catalina connector http httpconnector port 8080 minprocessors 5 maxprocessors 75 enablelookups true redirectport 8443 acceptcount 10 debug 0 connectiontimeout 60000 add one more directive to this statement allowtrace false eg connector classname org apache catalina connector http httpconnector port 8080 minprocessors 5 maxprocessors 75 allowtrace false enablelookups true redirectport 8443 acceptcount 10 debug 0 connectiontimeout 60000 author john bartelt
