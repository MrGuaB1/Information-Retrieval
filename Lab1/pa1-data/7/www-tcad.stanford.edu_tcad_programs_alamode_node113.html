tr bdf2 next up previous next nonlinear solution algorithms up time integration algorithms previous remarks on generalized trapezoid tr bdf2 although backward euler has properties appropriate for robustly integrating the stiff systems of odes arising from semiconductor diffusion models it is only first order accurate the tr bdf2 method discussed in 1 provides a second order accurate a stable and l stable single step method comprised of a trapezoid step over part of the time step followed by a second order backward difference step over the remainder of the time step let and be the computed solution at the tr substep goes from to via the bdf2 substep goes from to via the constant multiplying the truncation error is minimized if this value of gamma also produces identical jacobians for both the tr and bdf2 steps the local truncation error lte can be used to estimate a reasonable next time step one approach is to use the divided difference formula is used to estimate the lte note that c is the constant multiplying the highest order truncation term in the method the lte is compared to an allowable error tolerance to produce a rms measure of the normalized pointwise error let and then the rms measure of the normalized pointwise error is given by a candidate next time step is chosen as if r is reasonably small say less than 2 the error in the timestep is assumed to be acceptable and the next time step is chosen to be the 2 times cap on increases is to avoid stepsize oscillations if r is too large the current timestep is repeated with a second timestep estimator is based on a lte estimate computed using a milne's device a second tr step is taken from to the solutions of the bdf2 step and the second tr step are compared and used to estimate the truncation error see 4 for more details next up previous next nonlinear solution algorithms up time integration algorithms previous remarks on generalized trapezoid dan yergeau wed jun 18 19 17 04 pdt 1997
