ifndef jos_inc_scopeguard_hh define jos_inc_scopeguard_hh extern c include stdio h include inc error hh template class t void delete_obj t o delete o template class t void free_indir t p free p template class r class t class scope_guard public scope_guard r cb t t p cb_ cb p_ p active_ true scope_guard r cb t t p bool active cb_ cb p_ p active_ active void dismiss active_ false scope_guard force void force if active_ dismiss try cb_ p_ catch std exception &e printf scope_guard s n e what private scope_guard const scope_guard& scope_guard &operator const scope_guard& r cb_ t t p_ bool active_ template class r class t1 class t2 class scope_guard2 public scope_guard2 r cb t1 t2 t1 p1 t2 p2 cb_ cb p1_ p1 p2_ p2 active_ true scope_guard2 r cb t1 t2 t1 p1 t2 p2 bool active cb_ cb p1_ p1 p2_ p2 active_ active void dismiss active_ false scope_guard2 force void force if active_ dismiss try cb_ p1_ p2_ catch std exception &e printf scope_guard s n e what private scope_guard2 const scope_guard2& scope_guard2 &operator const scope_guard2& r cb_ t1 t2 t1 p1_ t2 p2_ bool active_ endif
