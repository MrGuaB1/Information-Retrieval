v22 0480 002 lab 1 advanced os lab 1 unix shell in this lab you will build a simple unix shell the shell will print a simple prompt and read a command line from its standard input it will then interpret the line read as the name of a program to execute followed by a list of zero or more arguments for example if your shell is called ash it will behave like this ash ls al drwxr xr x 2 dm classadm 512 oct 27 2003 drwxr xr x 7 dm classadm 2560 sep 10 23 32 rw r r 1 dm classadm 2858 oct 27 2003 cshrc rw r r 1 dm classadm 212 jan 12 2001 login rw r r 1 dm classadm 105 may 13 2000 mailrc rw r r 1 dm classadm 264 jan 16 2001 profile rw r r 1 dm classadm 126 sep 17 2003 rhosts rw r r 1 dm classadm 2110 sep 11 00 01 ash c rw r r 1 dm classadm 2110 sep 11 00 02 ash echo hello hello in addition to running simple commands your shell must support the following features background jobs if the command line contains a simple & character this means the job should be run in the background your shell should print the process id and then immediately print the prompt again and read another command before printing the prompt however your shell should check to see if any background processes have exited if so it should print the process id and done if the process exited with zero or done n if the process exited with value n or killed n if the process was terminated with signal n you may find the sleep and kill commands useful for debugging this feature for example ash sleep 20 & 27717 kill 27717 27717 killed 15 sleep 1 & 19624 type return after one second 19624 done false & 31190 return 31190 done 1 output redirection if the command is followed by a an argument beginning the rest of the argument is taken to be a file name into which the standard output file descriptor 1 of the program should go for example ash echo test test file cat test file test input redirection similarly if the command is followed by a an argument beginning the rest of the argument is taken to be a file name from which the of standard input file descriptor 1 of the program should go for example ash echo test test file cat test file test cat test file test file 2 cat test file2 test pipes if an argument appears that consists of a it separates two commands the first command should be run with its standard input connected to the second program's standard output for example ash echo test cat test echo test test file cat test file cat test cat test file cat cat test getting started if you want you can simply write the shell from scratch to compile and run a c program if you call your program ash c we recommand using the arguments cc ansi wall o ash ash c ash the whole lab should only require about 250 lines of code to implement if you are stuck and would like some help getting started you can download and examine this partially implemented shell this partially implemented shell supports executing programs and input and output redirection however it does not support pipes or background processes what to hand in you must submit two things a complete software distribution of your shell which can be a single ash c file if you did not need more than one source file a script file showing how you tested your shell to create a script file use the script command when you run script everything you type gets saved in a file called typescript press ctrl d to finish the script the typescript should be copied to the same directory as the software for example script script started output file is typescript ash d d script done output file is typescript cp ash c typescript class handin lab1 logname if you have any problems with submission please contact the ta or instructor references you may find it helpful to consult the system manual pages for various system calls and c library routines you can do so with the man command for instance man man describes the manual command itself in particular you may find the following man pages helpful close 2 dup2 2 execvp 3 _exit 2 exit 3 fork 2 open 2 pipe 2 waitpid 2 the parenthesized number says which section of the manual contains the documentation do not actually give that number to the man command
