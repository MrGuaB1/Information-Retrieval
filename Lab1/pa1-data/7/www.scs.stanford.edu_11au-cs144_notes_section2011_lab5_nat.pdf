arda kara cs 144 page 1 lab 5 nat arda kara cs 144 friday november 18 11 page 2 overview lab 5 builds on lab 3 myths and internet are inside eth0 app servers are outside eth 0 icmp echo and tcp nat will rewrite source ips of outbound packets clean up defunct mappings friday november 18 11 1 keep all icmp errors from lab 3 the non n version should function the same 2 3 packets from myth to app server will be rewritten with nat's external ip incoming packets will get back their original ip the internal ips are not private 10 ips 4 you will be responsible for ping icmp echo and downloading files over http tcp 5 clean out mappings based on tcp state etc page 3 parts icmp translate ip addr and query identifier a la port tcp endpoint independent mapping and filtering simultaneous open for unsolicited syns mapping any non common port 1023 clean up use the mappingtype_timeout values separate thread to go through and clean up testing nat topology served page displays addr port filtering reference binary friday november 18 11 icmp the combination of query sequence numbers should be unique you can think of the query identifier as the port you should have endpoint independent mapping tcp end independent mapping and filtering recalculate checksum including pseudoheader simul open both sides first send syns clean up remember to lock table go through and mark for deletion look at how the arp cache worked do not return mappings that are marked for deletion make sure you use the customizable values of icmp established tcp and transitory tcp timeouts testing filtering makes sure you can put packets on the right side of the nat page 4 lab 5 due december 7 last year's piazza http piazza com public ge57akd2pfn other cs144fall2010 start early friday november 18 11
