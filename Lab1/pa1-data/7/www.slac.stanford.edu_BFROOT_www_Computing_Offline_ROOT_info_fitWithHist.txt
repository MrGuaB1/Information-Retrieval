from rene brun rene brun cern ch sender owner roottalk pcroot cern ch to stephen bailey bailey physics harvard edu cc root discussion list roottalk pcroot cern ch subject re root fitting a th1 tf1 to a th1 date thu 08 mar 2001 11 48 53 0000 stephen bailey wrote hello i have a histogram which is comprised of signal and background i have a template histogram for the background and a function shape for the signal i would like to fit the template histogram and the signal function to the data histogram to get their relative normalizations is there a way to do this easily in root thanks stephen hi stephen here is a naive example rene brun example of fit where the model is histogram function th1f background void histgen generate the histogram background and save it to a file background taken as linearly decreasing tf1 f1 f1 pol1 0 10 f1 setparameters 5 0.5 th1f h background linear background 100 0 10 h fillrandom f1 10000 tfile f background root recreate save the background histogram h write superimpose a gaussian signal to the background histogram tf1 f2 f2 gaus 0 10 f2 setparameters 1 6 0.5 h fillrandom f2 2000 h setname result h write double_t ftotal double_t x double_t par double_t xx x 0 int_t bin background getxaxis findbin xx double_t br par 3 background getbincontent bin double_t arg xx par 1 par 2 double_t sr par 0 tmath exp 0.5 arg arg return sr br void fithist fit function ftotal to signal background histgen tfile f new tfile background root background th1f f get background global pointer used in ftotal th1f result th1f f get result tf1 ftot new tf1 ftot ftotal 0 10 4 double_t norm result getmaximum ftot setparameters 0.5 norm 5 2 norm ftot setparlimits 0 3 norm norm result fit ftot b
