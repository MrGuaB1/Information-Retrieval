conditional observables conditional observables joe tuggle babar root roofit workshop december 2007 2 conditional pdfs a conditional probability density function answers the question given y what is the probability density of x y is the conditional observable this is not a 2 dimensional probability density that would be what is the combined probability density of x and y in effect the observable y gets demoted from the argument of a function to a parameter of it 3 example let m es be defined in the range 5.2 5.3 gev c 2 and let 20 given an endpoint of 5.29 gev c 2 what is the probability to find m es in the range 5.275 5.285 gev c 2 0.07573 if the endpoint is 5.2981 gev c 2 the probability becomes 0.08777 4 5 relation to 2d pdfs on the first slide i said that a conditional pdf p x y is not a 2d pdf we ll denote the 2d pdf by p x y however these things are related to get the full 2d pdf you need to know something about the distribution of y whereas with the conditional version you don t care p x y p x y p y 6 effect on normalization when you want to get something useful out of your pdf it needs to be normalized to normalize a regular 2d pdf p x y you divide by however since a conditional pdf p x y treats y as a parameter you only divide a conditional pdf by 7 fitting your likelihood function is the product of normalized probability densities of all events in your data set if your pdf is just p x y then the constant denominator is irrelevant to maximizing the likelihood however 8 fitting if you re using p x y then each event is weighted by and your likelihood function becomes 9 fitting in roofit you can tell it to treat certain observables as conditional when you fit your pdf roorealvar x roorealvar y roodataset ds roosomepdf mypdf mypdf mypdf x y mypdf fitto ds conditionalobservables rooargset y 10 plotting the different normalization required when using conditional observables also affects plotting to project out an observable from a 2d pdf you just integrate however if y is conditional then it's a parameter not something you integrate over 11 plotting since we can t integrate over y we average instead of we take an average over the data to get 12 plotting in roofit you can tell it to average over the data when plotting specifying the rooargset of conditional observables is crucial otherwise you get an average over all of the observables in the dataset which is probably not what you want if this method takes too long to calculate you can bin your conditional observable in a roodatahist and pass that as the data set argument roorealvar x roorealvar y roodataset ds roosomepdf mypdf mypdf mypdf x y rooplot myplot x frame mypdf ploton myplot projwdata rooargset y ds 13 toy mc since a conditional pdf knows nothing about the distribution of its conditional observable that information has to come from somewhere else can t just generate toy mc from your pdf if you really don t know anything about the observable you can take it from your actual data set or the centrally produced mc can run into statistics issues if you want to do a lot of toys otherwise you can make up a reasonable pdf for it and generate a prototype dataset from that pdf 14 toy mc to specify conditional observables and prototype data in roofit declare your roomcstudy like this rooabspdf thefullpdf rooargset allobservables roodataset theydistr ypdf generate nevt roomcstudy mystudy thefullpdf allobservables conditionalobservables rooargset y protodata theydistr 15 pitfalls if your conditional observable has a different distribution for different species like signal and background then your fit can be biased for a simple example see arxiv physics 0401045v1 physics data an not really a problem with the m es endpoint example but conceivably a problem in other applications you might notice this in embedded toy studies it can be explicitly tested in pure toys by generating with different distributions of your conditional observable for signal and background then fitting with the conditional pdfs 16 summary some observables have to be treated on an event by event basis this affects the normalization of your pdfs and therefore impacts the way you fit plot and validate your fitter watch out for conditional observables that look very different between signal and background events if they are so different maybe you should use this as a discriminating observable in your fit roofit has built in methods to properly deal with conditional observables but you have to tell it how to handle them
