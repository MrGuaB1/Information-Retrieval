two way anova via jags simon jackman 11 17 2010 library pscl data presidentialelections data data data state dc & data year 1971 data j match data state unique data state data k match data year sort unique data year a data bundle that will go to jags forjags list y data demvote j data j n dim data 1 j max data j initial values for 2 chains inits list list mu 20 omega 1 sigma 2 rng seed 1234 rng name base mersenne twister list mu 80 omega 9 sigma 9 rng seed 99999 rng name base mersenne twister hand off to jags library rjags model compilation phase foo jags model file madridwednesday bug n chains 2 inits inits data forjags gibbs sampler is actually here out coda samples foo n iter 10e3 thin 1 variable names c mu sigma omega convergence and run length diagnostics sink geweke out geweke diag out sink sink raftery out raftery diag out sink extract alphas in separate object out coda samples foo n iter 5e3 thin 1 variable names c alpha stack the output from the two chains on top of one another alpha rbind out 1 out 2 dimnames alpha list null unique data state alphabar colmeans alpha column means of matrix alpha names alphabar unique data state indx order alphabar permutation of indices that order alphabar alphaci apply alpha 2 function x hpdinterval as mcmc x alphaci t alphaci compute posterior probability that utah wyoming mean alpha utah alpha wyoming caterpillar plot of alphas a la league table par mar c 3 5 3 1 plot x alphabar indx xlim range alphaci y 1 50 pch 16 xlab expression alpha ylab axes false for i in 1 50 lines y c i i x alphaci indx i text x alphaci indx 1 y 1 50 pos 2 unique data state indx which state is the median occupies rank 26 r apply alpha 1 rank r t r medianpostprob apply r 2 function x mean x 26
