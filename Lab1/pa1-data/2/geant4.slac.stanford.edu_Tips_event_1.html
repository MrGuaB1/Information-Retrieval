how can i get the information of the original primary particle g4track is a transient class and there is no given way to store the generation of the particles there is a user class named g4vusertrackinformation which can be attached to g4track that is by creating a concrete class object derived from this abstract base class and attaching it to g4track you can keep primary information with any secondary particle a sample implementation of g4vusertrackinformation is the following header file t01trackinformation hh ifndef t01trackinformation_h define t01trackinformation_h 1 include globals hh include g4threevector hh include g4particledefinition hh include g4track hh include g4allocator hh include g4vusertrackinformation hh class t01trackinformation public g4vusertrackinformation public t01trackinformation t01trackinformation const g4track atrack t01trackinformation const t01trackinformation atrackinfo virtual t01trackinformation inline void operator new size_t inline void operator delete void atrackinfo inline int operator const t01trackinformation& right const return this &right void print const private g4int originaltrackid g4particledefinition particledefinition g4threevector originalposition g4threevector originalmomentum g4double originalenergy g4double originaltime public inline g4int getoriginaltrackid const return originaltrackid inline g4particledefinition getoriginalparticle const return particledefinition inline g4threevector getoriginalposition const return originalposition inline g4threevector getoriginalmomentum const return originalmomentum inline g4double getoriginalenergy const return originalenergy inline g4double getoriginaltime const return originaltime extern g4allocator t01trackinformation atrackinformationallocator inline void t01trackinformation operator new size_t void atrackinfo atrackinfo void atrackinformationallocator mallocsingle return atrackinfo inline void t01trackinformation operator delete void atrackinfo atrackinformationallocator freesingle t01trackinformation atrackinfo endif source file t01trackinformation cc include t01trackinformation hh include g4ios hh g4allocator t01trackinformation atrackinformationallocator t01trackinformation t01trackinformation originaltrackid 0 particledefinition 0 originalposition g4threevector 0 0 0 originalmomentum g4threevector 0 0 0 originalenergy 0 originaltime 0 t01trackinformation t01trackinformation const g4track atrack originaltrackid atrack gettrackid particledefinition atrack getdefinition originalposition atrack getposition originalmomentum atrack getmomentum originalenergy atrack gettotalenergy originaltime atrack getglobaltime t01trackinformation t01trackinformation const t01trackinformation atrackinfo originaltrackid atrackinfo originaltrackid particledefinition atrackinfo particledefinition originalposition atrackinfo originalposition originalmomentum atrackinfo originalmomentum originalenergy atrackinfo originalenergy originaltime atrackinfo originaltime t01trackinformation t01trackinformation void t01trackinformation print const g4cout original track id originaltrackid at originalposition g4endl once you create above the class you have to implement for creating this class objects is g4usertrackingaction here is the sample implementation source file t01trackingaction cc include t01trackingaction hh include g4trackingmanager hh include g4track hh include g4trackvector hh include t01trackinformation hh t01trackingaction t01trackingaction t01trackingaction t01trackingaction void t01trackingaction preusertrackingaction const g4track atrack if atrack getparentid 0 && atrack getuserinformation 0 t01trackinformation aninfo new t01trackinformation atrack g4track thetrack g4track atrack thetrack setuserinformation aninfo void t01trackingaction postusertrackingaction const g4track atrack g4trackvector secondaries fptrackingmanager gimmesecondaries if secondaries t01trackinformation info t01trackinformation atrack getuserinformation size_t nseco secondaries size if nseco 0 for size_t i 0 i nseco i++ t01trackinformation infonew new t01trackinformation info secondaries i setuserinformation infonew now you can get the information of the primary particle associating with seconday g4track object thus for example in your sensitive detector implementation or in your g4usersteppingaction you can retrieve it as following source file for the case of a sensitive detector include t01trackinformation hh g4bool mysensitivedetector processhits g4step astep g4touchablehistory rohist t01trackinformation info t01trackinformation astep gettrack getuserinformation g4cout original track id info getoriginaltrackid g4endl makoto asai
