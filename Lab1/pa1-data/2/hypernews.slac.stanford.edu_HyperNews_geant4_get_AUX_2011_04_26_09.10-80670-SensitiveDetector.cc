include g4step hh include fstream include iostream include sensitivedetector hh include g4vprocess hh using namespace std sensitivedetector sensitivedetector g4string name g4vsensitivedetector name hist_max 1000 kev hist_min 1 kev for int i 0 i nobins i++ histogram i 0 g4bool sensitivedetector processhits g4step step g4touchablehistory hist g4string procname if step gettrack getcreatorprocess 0 procname step gettrack getcreatorprocess getprocessname g4cout procname g4endl if procname compt procname eioni procname phot procname conv double energy step gettrack getdynamicparticle gettotalenergy double energy step gettotalenergydeposit double bin_width hist_max hist_min nobins int index int floor energy hist_min bin_width if index 0 && index nobins histogram index if step gettrack gettrackid 2 g4cout secondary endl const g4vprocess creatorprocess g4vprocess step gettrack getcreatorprocess if creatorprocess getprocessname ioni g4cout ioni endl step gettrack settrackstatus fstopandkill return true void sensitivedetector endofevent g4hcofthisevent sensitivedetector sensitivedetector std ofstream file spectrum dat double bin_width hist_max hist_min nobins for int i 0 i nobins i++ double energy i bin_width hist_min file std setw 15 energy kev std setw 15 histogram i std endl
