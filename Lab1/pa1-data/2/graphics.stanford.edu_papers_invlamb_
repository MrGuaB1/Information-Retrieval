on the relationship between radiance and irradiance determining the illumination from images of a convex lambertian object on the relationship between radiance and irradiance determining the illumination from images of a convex lambertian object ravi ramamoorthi computer graphics laboratory pat hanrahan stanford university abstract we present a theoretical analysis of the relationship between incoming radiance and irradiance specifically we address the question of whether it is possible to compute the incident radiance from knowledge of the irradiance at all surface orientations this is a fundamental question in computer vision and inverse radiative transfer we show that the irradiance can be viewed as a simple convolution of the incident illumination ie radiance and a clamped cosine transfer function estimating the radiance can then be seen as a deconvolution operation we derive a simple closed form formula for the irradiance in terms of spherical harmonic coefficients of the incident illumination and demonstrate that the odd order modes of the lighting with order greater than one are completely annihilated therefore these components cannot be estimated from the irradiance contradicting a theorem due to preisendorfer a practical realization of the radiance from irradiance problem is the estimation of the lighting from images of a homogeneous convex curved lambertian surface of known geometry under distant illumination since a lambertian object reflects light equally in all directions proportional to the irradiance we briefly discuss practical and physical considerations and describe a simple experimental test to verify our theoretical results summary this paper derives an analytic formula for the irradiance in terms of the radiance the formula is in terms of spherical harmonics which can be thought of in some sense as the eigenfunctions of the lambertian brdf it is shown that the odd order modes of the illumination greater than one are completely annihilated so irradiance cannot be estimated from radiance there is also a deeper analysis of how positivity of the lighting affects the results and how this can allow for a solution in certain special cases finally we present empirical and theoretical evidence showing that in practice the irradiance depends only on the first 2 orders of spherical harmonic modes of the illumination and can be represented as a quadratic polynomial of the cartesian components of the surface normal in fact 99 of the energy of the lambertian brdf filter is contained by orders 0 1 and 2 in particular we care only about the first 2 orders of the illumination that is 9 parameters these first 9 coefficients are also all that can be determined regarding the lighting this 9 parameter model is likely to have wide impact in computer graphics and vision as we have already demonstrated for forward and inverse rendering results the figures on the right summarize some of the main results from the paper figures 1 2 our analytic irradiance formula in terms of spherical harmonic coefficients and the analytic values for the coefficients of the lambertian brdf filter these are the key results of the paper the coefficients of the lambertian brdf fall off as l 5 2 for even terms and vanish for odd terms 1 this makes radiance from irradiance formally ill posed as well as ill conditioned for frequencies l 2 figure 3 a plot of the spherical harmonic coefficients from the equations in figure 2 versus frequency l we see the rapid decay of coefficients and the zeros for odd modes greater than one figure 4 showing that we can indeed get the first 2 orders 9 terms of the lighting from the irradiance but that this fails miserably for higher orders relevant links josa 2001 paper in pdf 4m correction in equation 19 there is a small misprint the last term should be n 2 2 not n 2 2 related siggraph paper on environment mapping of diffuse objects using the 9 parameter approximation figure 1 the analytic formula for irradiance in terms of spherical harmonic coefficients figure 2 analytic formulae for spherical harmonic coefficients of lambertian brdf filter figure 3 plot of spherical harmonic terms in lambertian brdf filter figure 4 comparing recovered illumination for orders 2 and 4 from observations of the irradiance a near lambertian object to actual lighting ravi ramamoorthi last modified fri feb 15 07 35 46 pst 2002
