subroutine gustep user routine called at the end of each tracking step include geant321 gcflag inc include geant321 gconst inc include geant321 gckine inc include geant321 gcking inc include geant321 gctmed inc include geant321 gctrak inc include geant321 gcvolu inc include pvolum inc include celoss inc debug event and strore track for drawing if idebug ne 0 call gpcxyz if iswit 1 eq 1 and charge ne 0 call gsxyz if iswit 1 eq 2 call gsxyz something generated if ngkine gt 0 call gsking 0 energy deposited if destep gt 0 then radius sqrt vect 1 2 vect 2 2 nr 1 radius drx0 x0 nl 1 z1 vect 3 dlx0 x0 dedr nr dedr nr destep dedl nl dedl nl destep endif track length and total energy deposit if charge ne 0 then strch strch step edepch edepch destep else strne strne step edepne edepne destep endif energy of particles contributing to edep if destep gt 0 then elog log10 gekin destep pkine 3 call hfill 21 elog 0 destep endif end
