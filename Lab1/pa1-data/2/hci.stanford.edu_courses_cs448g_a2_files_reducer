usr bin env python diana maclean 2011 adapted fro cs448g from michael noll's tutorial on http www michael noll com tutorials writing an hadoop mapreduce program in python from operator import itemgetter import sys maps words to their counts word2count input comes from stdin for line in sys stdin remove leading and trailing whitespace line line strip parse the input we got from mapper py word count line split t 1 convert count currently a string to int try count int count word2count word word2count get word 0 count except valueerror count was not a number so silently ignore discard this line pass counted_words word2count items write the results to stdout standard output for word count in counted_words print s t s word count
