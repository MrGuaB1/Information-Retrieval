aes with vector permutations aes with vector permutations mike hamburg stanford university 2009 public domain this software is a public domain implementation following my paper on implementing aes using vector permute instructions doing so has several advantages it gives immunity to cache timing attacks it avoids copying sensitive data when possible it is faster on some machines it can be applied to either parallel modes cbc or sequential modes ctr this code is an implementation in x86 64 gnu c and assembly language it can be ported to other architectures but i haven t gotten to this yet and might not for a while here are performance numbers on 3 machines i tested performance in cycles byte cpu family mode 128 bit 192 bit 256 bit nehalem ctr 9.45 11.23 13.65 cbc 9.33 11.55 12.89 cbc 1 11.07 13.91 15.25 penryn ctr 11.64 13.74 15.86 cbc 11.35 13.49 15.53 cbc 1 13.80 16.41 19.18 conroe ctr 19.00 25.78 29.97 cbc 21.33 25.69 30.03 cbc 1 25.89 31.05 36.30 as you can see this code is quite fast on recent machines much faster than openssl and comparable to crypto++ the exception here is conroe which has a very slow shuffler vpaes doesn t yet implement ctr mode caching so ctr mode is not any faster than cbc mode furthermore encryption is faster than decryption due to the more complex mixcolumns matrix for decryption there are still several to do items in vpaes testing testing and more testing vpaes passes the nist test vectors but i haven t tested padding extensively secure memory allocation for the key schedule currently i m using malloc but i d rather use an allocator which locks allocations in the core more modes including macs such as cmac cbc mac and pmac and authenticated encryption modes such as ccm gcm and ocb mode ctr mode caching which should speed up ctr mode by 15 re port to x86_32 arm neon amd bulldozer and altivec microarchitecture specific optimizations submit to openssl and crypto++ even more testing i d also like to try these tricks with camellia and fugue which use the aes core download vpaes 312 kb note that this is a preliminary release is only minimally tested comes with no warranty etc please send questions or comments to mike hamburg changelog v0 5.1 fixed ctr mode carry bug v0 5 initial release
