library foreign tt read systat c robertson courses byu quant 2 work aldenderfer burial data syd write table tt file c robertson courses su data analysis data aldenderfer_burial dat col names t bur read table c robertson courses su data analysis data aldenderfer_burial dat header t sep hclust work hc1 hclust dist bur 4 11 method ward plclust hc1 labels bur 2 create a scree plot ncls 27 c 2 25 ncls plot ncls hc1 height type l xlim c 2 10 kmeans work km1 kmeans bur 4 11 3 km1 km1 cluster table km1 cluster bur 2 km plot bur 4 11 6 plot sse data for a series of k means solutions igr march 2006 km plot function m1 maxcls prepare vectors for plotting cluster number vs sse out clsnum c 1 maxcls out psse null calculate pre cluster sse mv apply m1 2 mean maxsse sum sweep m1 2 mv 2 out psse 1 100 calculate series of k means solutions for i in 2 maxcls cl kmeans m1 i express withinss as fraction of total pre cluster sse out psse i sum cl withinss maxsse 100 end of clustering loop dump the results plot out clsnum out psse type l xlab cluster solution ylab sse end of km plot function
