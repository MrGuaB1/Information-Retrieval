function p ryy rxy rle v d w b mmse snrmfb_in_db c teq p l mu delta sigma ex_bar filtertype programmed by ryoulhee kwak filtertype 1 fir 2 iir just for one pole filter p channel impulse response in case of fir p 1 0.5 d 2.3 d 2 p 1 0.5 2.3 in case of iir p 1 2.4 0.5 d p 2.4 0.5 sigma noise power in linear scale delta delay l number of taps c w p v eigen vectors d eigent values mu for b if filtertype 1 fir norm_p norm p temp size_p size p p toeplitz p 1 zeros 1 l 1 p zeros 1 l 1 ryy ex_bar p p sigma eye l l rxy zeros mu 1 delta eye mu 1 zeros mu 1 l size_p 2 mu delta p ex_bar rle eye mu 1 ex_bar rxy inv ryy rxy vd eig rle d_temp diag d m n min d_temp b norm_p v n w b rxy inv ryy conv w p mmse b rle b by using easy way to get error energy c conv w p alpa c delta 1 b 1 biased_error_energy norm_p 2 m ex_bar 1 alpa 2 unbiased_error_energy norm_p 2 m ex_bar 1 alpa 2 alpa 2 snrmfb norm_p 2 ex_bar unbiased_error_energy snrmfb_in_db 10 log10 snrmfb else iir in case of iir filter p matrix is infinite dimesion but there is a trick to get exact rxy ryy norm_p sqrt 1 p 1 2 1 p 2 p 1 2 temp size_p size p ptemp p 2 p 1 0 1 l 1 p 1 1 factor p toeplitz ptemp 1 zeros 1 l 1 ptemp ptemp toeplitz ptemp ptemp ryy ex_bar ptemp norm_p 2 sigma eye l l rxy zeros mu 1 delta eye mu 1 zeros mu 1 l 1 mu delta p ex_bar rle eye mu 1 ex_bar rxy inv ryy rxy vd eig rle d_temp diag d m n min d_temp b norm_p v n w b rxy inv ryy c conv w p sum conv w p 2 norm b 2 w 1 b 1 2 mmse b rle b by using easy way to get error energy alpa c delta 1 b 1 biased_error_energy norm_p 2 m ex_bar 1 alpa 2 unbiased_error_energy norm_p 2 m ex_bar 1 alpa 2 alpa 2 snrmfb norm_p 2 ex_bar unbiased_error_energy snrmfb_in_db 10 log10 snrmfb end
