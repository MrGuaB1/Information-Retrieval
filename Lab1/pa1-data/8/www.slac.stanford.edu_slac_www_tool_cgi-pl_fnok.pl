sub fnok local infn _ local fn home rest print test fnok test fnok n if infn a za z0 9 _ print fnok invalid character in filename infn n return if infn print fnok in filename infn n return if infn print fnok minus sign at start of filename infn n return if infn w+ is it a userid page address home ypmatch $1 passwd s s rest infn w+ fn home public_html rest elsif infn starts with not followed by so ok fn afs slac www infn else print fnok bad filename fn n return if fn slaconly i check whether it is visible slaconly if env remote_addr 134 79 check ip address return fn else print fnok slac only filename fn can t be viewed by env remote_addr n return return fn 1
