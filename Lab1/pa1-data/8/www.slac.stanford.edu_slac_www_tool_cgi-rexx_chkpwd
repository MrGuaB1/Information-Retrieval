chkpwd procedure parse arg passwordfile username password check's user's password fails if there is no such user returns zero if the password is correct otherwise returns an error message and message number the parameters passwordfile username and password must only contain alphanumerics plus _ this function uses the cern httpd password file that is maintained using the htadm program which is part of the cern httpd distribution at slac htadm is located at afs slac g www bin htadm sun or afs slac g www bin htadm aix before using this function the password admin must use the htadm function to create the password file and enter the password for the selected username example msg chkpwd afs slac u sf cottrell www test pwd cottrell password if passwordfile then return chkpwd 1 null passwordfile name given if lines passwordfile 0 then return chkpwd 2 either can t find or found an empty passwordfile passwordfile if username then return chkpwd 3 needs a username but none was provided if password then return chkpwd 4 needs a password but none was provided if length password 8 then return chkpwd 5 password must be 8 characters or less parms passwordfile username password if suspect parms then return chkpwd 6 suspect parms in input parameters fail popen afs slac g www bin htadm sun check parms if queued 0 then parse pull line else return chkpwd 10 fail htadm failed maybe a problem with passwordfile passwordfile if fail 0 then return chkpwd fail username password line if line correct then return 0 else return line
