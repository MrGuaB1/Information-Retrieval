function gn en bn b_bar snrdmt dmtlcra p snrrcvr ex_bar n gap ee379c 2008 spring levin campello's method with dmt inputs p is the pulse response an nu is set to length p 1 snrrcvr is the channel output snr for an iid input ex_bar is the normalized energy n is the total number of real complex subchannels n 2 gap is the gap in db outputs gn is the vector of channel gains en is the vector energy distribution pam or qam bn is the vector bit distribution pam or qam b_bar is the number of bits per dimension in the dmt symbol the first and last bins are pam the rest are qam db into normal scale noise_var ex_bar norm p 2 10 snrrcvr 10 gap 10 gap 10 nu length p 1 initialization en zeros 1 n 2 1 bn zeros 1 n 2 1 gn zeros 1 n 2 1 hn zeros 1 n 2 1 decision_table zeros 1 n 2 1 subchannel center frequencies f 0 1 n 1 2 find hn vector for i 1 length p hn hn p i exp j 2 pi f i 1 end find gn vector gn abs hn 2 noise_var debugging purpose plot gn levin campello loading initialization used energy so far e_so_far 0 decision table qam and pam decision_table 2 n 2 2 gap gn 2 n 2 gap formula incremental energies if gn 1 0 decision_table 1 3 gap gn 1 else decision_table 1 inf end if gn n 2 1 0 decision_table n 2 1 3 gap gn n 2 1 else decision_table n 2 1 inf end decision_table debugging purpose while 1 y index min decision_table e_so_far e_so_far y if e_so_far ex_bar n break else en index en index y bn index bn index 1 if index 1 index n 2 1 decision_table index 4 decision_table index else decision_table index 2 decision_table index end end end calculate b_bar b_bar 1 n nu sum bn snrdmt 10 log10 gap 2 2 b_bar 1
