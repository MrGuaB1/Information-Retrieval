name facprime purpose factor a number into its prime numbers category math calling sequence result facprime n sum sum inputs n number to factor into primes outputs returns a two dimensional array lonarr 2 nprime where nprime is the number of unique prime numbers the first dimension holds the value of each unique prime result 0 and the second dimension holds the frequency or number of times that prime occurs result 1 common blocks facprime holds an array containing the first 100000 prime numbers restrictions the number to be factored must be 1299709 example pnums facprime 63500 factor 63500 into it pnums help pnums pnums long array 2 3 print reform pnums 0 2 5 127 print reform pnums 1 2 3 1 ck 1l 2 2 5 3 127 63500 for i 0 2 do ck ck long pnums 0 i pnums 1 modification history written by han wen august 1996 11 aug 1996 missing prime number 2 in factoring eliminate prime number 1 from result function facprime n1 sum sum common facprime prime_num if n_elements prime_num eq 0 then restore grpkpath prime10 sav n n1 i 0l r 1l 0l repeat begin r r prime_num i 0 repeat begin rem n mod prime_num i if rem eq 0 then begin n n prime_num i j 2l i 2 1 r j r j 1 endif endrep until rem ne 0 i i 1l endrep until n lt prime_num i r reform r 2 i 1 overwrite hgt0 where r 1 gt 0 r r hgt0 sum long total reform r 0 reform r 1 return r end
