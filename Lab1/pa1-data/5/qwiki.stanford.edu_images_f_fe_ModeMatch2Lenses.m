this script is used to do two lens modematching lambda 1064e 9 yag wavelength 1064 nm w0yag 4e 3 the yag has a 4mm waist w1 25e 3 these are the measured diameters for the hpuc coupler w2 1.15 e 3 x 762 this is the separation between the waist measurements f1 05 focal length for first lens f2 025 focal length for second lens l1 4 distance from input waist to first lens calculate q for the yag qyag i pi w0yag 2 lambda extract the beam parameters from the measured waists q0 w0 zr z getbeamparameters w1 w2 x lambda fprintf the input beam has parameters w0 f mm z f mm n w0 1000 z 1000 calculate the focus parameters of the first lens lint1 f1 f1 l1 l1 2 qyag 2 f1 2 2 l1 f1 l1 2 qyag 2 qint1 f1 2 qyag f1 2 2 l1 f1 l1 2 qyag 2 now we run the one lens modematching using the intermediate waist and the second lens lint2 l3 getmodematchlength qint1 q0 f2 if lint2 0 fprintf i m sorry we found no solution n return end l2 lint1 lint2 fprintf the mode matching network with lenses of f1 fmm f2 fmm n f1 1000 f2 1000 fprintf has l1 fmm l2 fmm and l3 fmm n n l1 1000 l2 1000 l3 1000
