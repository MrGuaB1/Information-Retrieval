head1 name pefest find prediction error filter avoid bursty noise head1 synopsis c call pefest1 dd aa niter head1 input parameters over 4 item dd c real input data item niter integer number of itterations back head1 output parameters over 4 item aa type filter output filter back head1 description find prediction error filter helix magic avoid bursts head1 see also l npef l hconest l solver l cgstep l pef head1 library b geef90 cut module pefest estimate a pef avoiding zeros and bursty noise on input use quantile_mod use helicon use misinput use pef contains subroutine pefest1 niter yy aa integer intent in niter real dimension pointer yy type filter aa real dimension allocatable rr real rbar integer stat allocate rr size yy call helicon_init aa starting guess stat helicon_lop false false yy rr rbar quantile size yy 3 abs rr rbar r safe below rbar where aa mis yy 0 call find_mask yy 0 and abs rr 5 rbar aa call find_pef yy aa niter deallocate rr
