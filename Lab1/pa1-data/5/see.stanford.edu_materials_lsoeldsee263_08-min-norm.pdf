lecture 8 least norm solutions of undetermined equations page 1 ee263 autumn 2007 08 stephen boyd lecture 8 least norm solutions of undetermined equations least norm solution of underdetermined equations minimum norm solutions via qr factorization derivation via lagrange multipliers relation to regularized least squares general norm minimization with equality constraints 8 1 page 2 underdetermined linear equations we consider y ax where a r m n is fat m n ie there are more variables than equations x is underspecified ie many choices of x lead to the same y we ll assume that a is full rank m so for each y r m there is a solution set of all solutions has form x ax y xp z z n a where xp is any particular solution ie axp y least norm solutions of undetermined equations 8 2 page 3 z characterizes available choices in solution solution has dimn a n m degrees of freedom can choose z to satisfy other specs or optimize among solutions least norm solutions of undetermined equations 8 3 page 4 least norm solution one particular solution is xln a t aa t 1 y aat is invertible since a full rank in fact xln is the solution of y ax that minimizes x ie xln is solution of optimization problem minimize x subject to ax y with variable x r n least norm solutions of undetermined equations 8 4 page 5 suppose ax y so a x xln 0 and x xln t xln x xln t a t aa t 1 y a x xln t aa t 1 y 0 ie x xln xln so x 2 xln x xln 2 xln 2 x xln 2 xln 2 ie xln has smallest norm of any solution least norm solutions of undetermined equations 8 5 page 6 n a x ax 0 xln x ax y orthogonality condition xln n a projection interpretation xln is projection of 0 on solution set x ax y least norm solutions of undetermined equations 8 6 page 7 a at aat 1 is called the pseudo inverse of full rank fat a at aat 1 is a right inverse of a i at aat 1a gives projection onto n a cf analogous formulas for full rank skinny matrix a a at a 1at at a 1at is a left inverse of a a at a 1at gives projection onto r a least norm solutions of undetermined equations 8 7 page 8 least norm solution via qr factorization find qr factorization of at ie at qr with q r n m qt q im r r m m upper triangular nonsingular then xln at aat 1y qr t y xln r t y least norm solutions of undetermined equations 8 8 page 9 derivation via lagrange multipliers least norm solution solves optimization problem minimize xt x subject to ax y introduce lagrange multipliers l x  xt x t ax y optimality conditions are xl 2x a t  0 l ax y 0 from first condition x at  2 substitute into second to get  2 aat 1y hence x at aat 1y least norm solutions of undetermined equations 8 9 page 10 example transferring mass unit distance f unit mass at rest subject to forces xi for i 1 t i i 1 10 y1 is position at t 10 y2 is velocity at t 10 y ax where a r 2 10 a is fat find least norm force that transfers mass unit distance with zero final velocity ie y 1 0 least norm solutions of undetermined equations 8 10 page 11 0 2 4 6 8 10 12 0 0.2 0.4 0.6 0.8 1 0 2 4 6 8 10 12 0 0.05 0.1 0.15 0.2 0 2 4 6 8 10 12 0.06 0.04 0.02 0 0.02 0.04 0.06 x ln p osition velocity t t t least norm solutions of undetermined equations 8 11 page 12 relation to regularized least squares suppose a r m n is fat full rank define j1 ax y2 j2 x2 least norm solution minimizes j2 with j1 0 minimizer of weighted sum objective j1 j2 ax y2 x2 is x a t a i 1 a t y fact x xln as  0 ie regularized solution converges to least norm solution as  0 in matrix terms as  0 at a i 1 a t at aat 1 for full rank fat a least norm solutions of undetermined equations 8 12 page 13 general norm minimization with equality constraints consider problem minimize ax b subject to cx d with variable x includes least squares and least norm problems as special cases equivalent to minimize 1 2 ax b2 subject to cx d lagrangian is l x  1 2 ax b 2  t cx d 1 2 x t a t ax b t ax 1 2 b t b  t cx  t d least norm solutions of undetermined equations 8 13 page 14 optimality conditions are xl a t ax a t b c t  0 l cx d 0 write in block matrix form as at ac t c 0 x  at b d if the block matrix is invertible we have x at ac t c 0 1 at b d least norm solutions of undetermined equations 8 14 page 15 if at a is invertible we can derive a more explicit and complicated formula for x from first block equation we get x a t a 1 a t b c t  substitute into cx d to get c a t a 1 a t b c t  d so  c a t a 1 c t 1 c at a 1 a t b d recover x from equation above not pretty x a t a 1 at b c t c at a 1 c t 1 c at a 1 a t b d least norm solutions of undetermined equations 8 15
