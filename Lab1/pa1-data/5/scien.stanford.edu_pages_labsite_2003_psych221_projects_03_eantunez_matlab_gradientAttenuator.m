function phi gradientattenuator h alpha beta gradhx 0.5 zeros size h 1 1 h 3 end h 1 end 2 zeros size h 1 1 gradhy 0.5 zeros 1 size h 2 h 3 end h 1 end 2 zeros 1 size h 2 gradh sqrt gradhx 2 gradhy 2 phi gradh alpha mean2 gradh beta 1 phi phi 1 1 if any mod size h 2 & all size h 32 if both dimensions are divisible by 2 disp generating one more level on the pyramid sized num2str size h disp min phi num2str min2 phi max phi num2str max2 phi phi phi expand gradientattenuator reduce 5 h alpha beta end
