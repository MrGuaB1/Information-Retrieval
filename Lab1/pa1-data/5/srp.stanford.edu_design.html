srp design specifications srp protocol design srp is the newest addition to a new class of strong authentication protocols that resist all the well known passive and active attacks over the network srp borrows some elements from other key exchange and identification protcols and adds some subtle modifications and refinements the result is a protocol that preserves the strength and efficiency of the eke family protocols while fixing some of their shortcomings the following is a description of srp 6 and 6a the latest versions of srp na large safe prime n 2q 1 where q is prime all arithmetic is done modulo n g a generator modulo n k multiplier parameter k h n g in srp 6a k 3 for legacy srp 6 s user's salt i username p cleartext password h one way hash function modular exponentiation u random scrambling parameter a b secret ephemeral values a b public ephemeral values x private key derived from p and s v password verifier the host stores passwords using the following formula x h s p s is chosen randomly v g x computes password verifier the host then keeps i s v in its password database the authentication protocol itself goes as follows user host i a g a identifies self a random number host user s b kv g b sends salt b random number both u h a b user x h s p user enters password user s b kg x a ux computes session key user k h s host s av u b computes session key host k h s now the two parties have a shared strong session key k to complete authentication they need to prove to each other that their keys match one possible way user host m h h n xor h g h i s a b k host user h a m k the two parties also employ the following safeguards the user will abort if he receives b 0 mod n or u 0 the host will abort if it detects that a 0 mod n the user must show his proof of k first if the server detects that the user's proof is incorrect it must abort without showing its own proof of k a paper describing this protocol is also available as well as a conference paper describing an older version of the protocol for historical interest descriptions of the previous versions of srp are available on this site srp 1 srp 2 srp 3 back
