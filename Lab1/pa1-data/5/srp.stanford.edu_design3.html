srp design specifications srp 3 protocol design srp 3 was the protocol published in 1998 and described in rfc2945 it solved the security problems of srp 1 and srp 2 and is still widely used it suffers from the two for one password guessing attack and requires the server to wait for one of the client's messages before sending its own both these issues have been addressed by srp 6 which is recommended for new applications na large safe prime n 2q 1 where q is prime all arithmetic is done modulo n g a generator modulo n s user's salt u username p cleartext password h one way hash function modular exponentiation t security parameter u random scrambling parameter a b secret ephemeral values a b public ephemeral values x private key derived from p and s v password verifier the host stores passwords using the following formula x h s p s is chosen randomly v g x computes password verifier the host then keeps u s v in its password database the authentication protocol itself goes as follows user host u a g a identifies self a random number host user s b v g b u sends salt b random number u t bit random number user x h s p user enters password user s b g x a ux computes session key user k h s host s av u b computes session key host k h s now the two parties have a shared strong session key k to complete authentication they need to prove to each other that their keys match one possible way user host m h h n xor h g h u s a b k host user h a m k the two parties also employ the following safeguards the user will abort if he receives b 0 mod n or u 0 the host will abort if it detects that a 0 mod n the user must show his proof of k first if the server detects that the user's proof is incorrect it must abort without showing its own proof of k back
