function znm zernike n m x y d class psych 221 ee 362 function zernike m author patrick maeda purpose compute zernike polynomial date 02.28 03 matlab 6.1 03.03 03 zernike m is a function that computes the values of a zernike polynomial over a circular pupil of diameter d output znm is the zernike polynomial term of order n and frequency m input n highest power or order of the radial polynomial term a positive integer m azimuthal frequency of the sinusoidal component a signed integer m n x 1 d array of pupil x coordinate values length x must equal length y y 1 d array of pupil y coordinate values length y must equal length x d pupil diameter the zernike polynomial definitions used are taken from thibos l applegate ra schweigerling jt webb r vsia standards taskforce members standards for reporting the optical aberrations of eyes osa trends in optics and photonics vol 35 vision science and its applications lakshminarayanan v ed optical society of america washington dc 2000 pp 232 244 initialize circular pupil function imax length x jmax length y a d 2 for i 1 imax initialize circular pupil for j 1 jmax p i j sqrt x i 2 y j 2 a end end compute normalization constant nnm sqrt 2 n 1 1 m 0 compute zernike polynomial if n 0 znm p else znm zeros imax jmax for i 1 imax for j 1 jmax r sqrt x i 2 y j 2 if x i 0 & y j 0 x i 0 & y j 0 theta atan y j x i 1e 20 else theta pi atan y j x i 1e 20 end for s 0 0.5 n abs m znm i j znm i j 1 s factorial ns r a n 2 s factorial s factorial 0.5 n abs m s factorial 0.5 n abs m s end znm i j p i j nnm znm i j m 0 cos m theta m 0 sin m theta end end end
