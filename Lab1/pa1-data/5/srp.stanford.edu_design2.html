srp 2 design specifications srp 2 protocol design this is a description of srp 2 which resists the attack recently discovered against srp 1 although there are no known weaknesses in srp 2 its use of a composite modulus with unknown factorization makes parameter certification a serious issue the srp 3 protocol avoids these issues by using a safe prime modulus and fixes the weakness in srp 1 using a different technique n the product of two safe primes p and q p 2j 1 q 2k 1 j k p q all prime all arithmetic is done modulo n g a generator of the group g p 1 q 1 2 mod n s user's salt u username p cleartext password h one way hash function modular exponentiation ws ys secret values wp yp public values xs salted and hashed password xp password verifier the host stores passwords using the following formula xs s h p s is chosen randomly xp g xs computes password verifier the host then keeps u s xp in its password database the authentication protocol itself goes as follows user host u wp g ws identifies self ws random number host yp g ys ys random number host user s z xp yp sends salt adds verifier to residue user xs s h p user enters password user yp z g xs recovers yp from message user s yp 2 ws xs computes session key user k h s host s wp 2 xp ys computes session key host k h s now the two parties have a shared strong session key k to complete authentication they need to prove to each other that their keys match one possible way user host h z k hash with host's value host user h wp k hash with user's value the two parties also employ the following safeguards the user will abort if he receives z 0 mod n the host will abort if it detects that wp 0 mod n the user must show his proof of k first if the server detects that the user's proof is incorrect it must abort without showing its own proof of k a paper describing this protocol is also available back
