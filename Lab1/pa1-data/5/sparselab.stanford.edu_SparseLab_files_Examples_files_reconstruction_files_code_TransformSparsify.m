function y transformsparsify mode n x transform if nargin 3 transform wavelet end switch transform case wavelet qmf makeonfilter haar s 3 x reshape x sqrt n sqrt n if mode 1 y iwt2_po x s qmf elseif mode 2 y fwt2_po x s qmf end y reshape y n 1 case laplacian l sparse 1 n 2 n 1 n 1 1 n 1 n 1 2 n 4 ones 1 n 1 ones 1 2 n 1 if mode 1 y l x elseif mode 2 y l x end case difference if mode 1 for k 1 n lower tri y k sum x 1 k end elseif mode 2 for k 1 n upper tri y k sum x k end end end y y end
