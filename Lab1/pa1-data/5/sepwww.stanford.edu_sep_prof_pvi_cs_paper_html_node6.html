convolution equation and program next up previous print clean next negative time up sampled data and z transforms previous dissecting systems by factoring convolution equation and program what do we actually do in a computer when we multiply two z transforms together the filter 2 z would be represented in a computer by the storage in memory of the coefficients 2 1 likewise for 1 z the numbers 1 1 would be stored the polynomial multiplication program should take these inputs and produce the sequence 2 1 1 let us see how the computation proceeds in a general case say 5 6 identifying coefficients of successive powers of z we get 7 in matrix form this looks like 8 the following equation called the convolution equation carries the spirit of the group shown in 7 9 to be correct in detail when we associate equation 9 with the group 7 we should also assert that either the input x k vanishes before k 0 or n b must be adjusted so that the sum does not extend before x 0 these end conditions are expressed more conveniently by defining j k i in equation 9 and eliminating k getting 10 a convolution program based on equation 10 including end effects on both ends is convolve convolution y z x z b z subroutine convolve nb bb nx xx yy integer nb number of coefficients in filter integer nx number of coefficients in input number of coefficients in output will be nx nb 1 real bb nb filter coefficients real xx nx input trace real yy 1 output trace integer ib ix iy ny ny nx nb 1 call null yy ny do ib 1 nb do ix 1 nx yy ix ib 1 yy ix ib 1 xx ix bb ib return end some details of the ratfor programming language are given in an appendix along with the subroutine zero which erases the space for the output next up previous print clean next negative time up sampled data and z transforms previous dissecting systems by factoring stanford exploration project 10 21 1998
