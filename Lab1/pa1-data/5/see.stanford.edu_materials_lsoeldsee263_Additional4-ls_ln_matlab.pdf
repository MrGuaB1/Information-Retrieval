least squares and least norm in matlab page 1 ee263 prof s boyd least squares and least norm in matlab least squares approximate solution suppose a rm n is skinny or square ie m n and full rank which means that rank a n the least squares approximate solution of ax y is given by xls at a 1at y this is the unique x rn that minimizes ax y there are several ways to compute xls in matlab the simplest method is to use the backslash operator xls a y if a is square and invertible the backslash operator just solves the linear equations ie it computes a 1y if a is not full rank then a b will generate an error message and then a least squares solution will be returned you can also use the formula to compute the least squares approximate solution xls inv a a a y we encourage you to verify that you get the same answer except possibly for some small difference due to roundoff error as you do using the backslash operator here you ll get an error if a is not full rank or fat compared with the backslash operator this method is a bit less efficient and a bit more sensitive to roundoff errors but you won t notice it unless m and n are at least several hundred or more you can also use the pseudo inverse function pinv which computes the pseudo inverse which is a at a 1at when a is full rank and skinny or square the pseudo inverse is also defined when a is not full rank but it's not given by the formula above to find the least suares approximate solution using the pseudo inverse you can use xls pinv a y you better be sure here that a is skinny or square and full rank otherwise you ll compute something with no warning messages that isn t the least squares approximate solution yet another method is via a qr decomposition in matlab q r qr a returns the full qr decomposition with square orthogonal q rm m and r rm n upper triangular with zeros in its bottom part the economy qr decomposition in which q rm n with orthonormal columns and invertible r is obtained using q r qr a 0 you can compute the least squares approximate solution using the economy qr decomposition using for example 1 page 2 q r qr a 0 compute economy qr decomposition xls r q y to be sure you ve really computed the least squares approximate solution we encourage you to check that the residual is orthogonal to the columns of a for example with the commands r a xy compute residual a r compute inner product of columns of a and r and checking that the result is very small least norm solution now suppose a rm n and is fat or square ie m n and full rank which means that rank a m the least norm solution of ax y is given by xln at aat 1y among all solutions of ax y xln has the smallest norm we can compute xln in matlab in several ways you can use the formula to compute xln xln a inv a a y you ll get an error here if a is not full rank or if a is skinny you can also use the pseudo inverse function pinv which computes the pseudo inverse which is a at aat 1 when a is full rank and fat or square the pseudo inverse is also defined when a is not full rank but it's not given by the formula above xln pinv a y you better be sure here that a is fat or square and full rank otherwise you ll compute something with no warning messages that isn t the least norm solution you can find the least norm solution via qr as well q r qr a 0 xln q r y warning we should also mention a method that doesn t work the backslash operator if a is fat and full rank then a y gives a solution of the ax y not necessarily the least norm solution 2
