section solution page 1 cs107 handout 28s spring 2008 may 13 2008 section solution solution rss news feed madness static struct ta bool available all true to start semaphore availlock all set to 1 to start semaphore requested student to ta rendezvous all set to 0 initially semaphore finished ta to student rendezvous all set to 0 initially int numbugs set by ta using examine function tas num_tas static semaphore numtasavailable set to num_tas static semaphore nummachinesavailable set to num_machines static int numstudentsleft num_students static semaphore studentsleftlock initially set to 1 static void ta int id while true semaphorewait tas id requested if numstudentsleft 0 return last student left tas id numbugs examine semaphoresignal tas id finished reademail static void student int numbugs 1 int ta semaphorewait nummachinesavailable while numbugs 0 && numbugs 10 debug semaphorewait numtasavailable for ta 0 ta num_tas ta++ semaphorewait tas ta availlock if tas ta available break semaphoresignal tas ta availlock tas ta available false semaphoresignal tas ta availlock semaphoresignal tas ta requested semaphorewait tas ta finished numbugs tas ta numbugs tas ta available true semaphoresignal numtasavailable page 2 2 if numbugs 0 rejoice semaphorewait studentsleftlock numstudentsleft bool everyonedone numstudentsleft 0 semaphoresignal studentsleftlock thought question why can t the two lines above be switched if everyonedone for ta 0 ta num_tas ta++ semaphoresignal tas ta requested semaphoresignal nummachinesavailable
