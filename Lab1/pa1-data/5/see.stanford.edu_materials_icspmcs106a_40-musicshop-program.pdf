h13 section 2 page 1 mehran sahami handout 40 cs 106a november 16 2007 musicshop program componentlistener example file musicshop java file musicshop java this program handles the data management for a music shop showing which albums are carried and how many copies are in stock the program handles dynamic resizing of the program window import acm program import acm util import java awt event import java io import java util import javax swing public class musicshop extends program set up initial display with interactors and canvas public void init label new jlabel album name albumname new jtextfield 20 add label south add albumname south canvas new musicshopdisplay add canvas loadinventory addactionlisteners albumname addactionlistener this read file to get inventory information on all albums private void loadinventory try bufferedreader rd new bufferedreader new filereader music data txt while true string line rd readline if line null break album album parseline line inventory put album getalbumname album rd close catch ioexception ex throw new errorexception ex page 2 2 parse a single line from inventory file and returns an album object that contains the information from the line private album parseline string line int albumnamestart line indexof 1 int albumnameend line indexof string albumname line substring albumnamestart albumnameend int bandnamestart line indexof albumnameend 1 1 int bandnameend line indexof albumnameend 1 string bandname line substring bandnamestart bandnameend int numstockedstart line indexof bandnameend 1 1 int numstocked integer parseint line substring numstockedstart return new album albumname bandname numstocked update the display whenever the user enters a new album name public void actionperformed actionevent e if e getsource albumname canvas displayinventory inventory get albumname gettext private instance variables private jlabel label private jtextfield albumname private musicshopdisplay canvas private hashmap string album inventory new hashmap string album file musicshopdisplay java file musicshopdisplay this file handles the display of album inventory for the music shop it provides dynamic redrawing of window contents when display is resized import acm graphics import java awt event public class musicshopdisplay extends gcanvas implements componentlistener constructor public musicshopdisplay addcomponentlistener this lastalbum null page 3 3 display the album name band name and number in stock for a single album if it is in our inventory otherwise just clear the display public void displayinventory album album removeall lastalbum album if album null int numstocked album getnumstocked add new glabel album album getalbumname by album getbandname 10 getheight bar_height 2 spacer display squares in dicating how many inventory double nextx spacer for int i 0 i numstocked i++ double barlength getwidth double max_inventory spacer grect rect new grect nextx getheight bar_height 2 barlength bar_height rect setfilled true add rect nextx barlength spacer glabel label new glabel numstocked in stock add label 10 getheight bar_height 2 spacer label getascent whenever we need to update the display continue to display the last album shown public void update displayinventory lastalbum public void componenthidden componentevent e public void componentmoved componentevent e public void componentresized componentevent e update public void componentshown componentevent e constants private static final double bar_height 20 private static final double spacer 10 private static final int max_inventory 20 private instance variables private album lastalbum page 4 4 file album java file album java keeps track of all the information for one album in the music shop including its name the number in stock and the band that its by public class album constructor public album string album string band int stock albumname album bandname band numstocked stock public string getalbumname return albumname public string getbandname return bandname public int getnumstocked return numstocked returns a string representation of an album listing the album name the band name and the number in stock public string tostring return albumname by bandname numstocked in stock private instance variables private string albumname private string bandname private int numstocked file music data txt snakes and arrows rush 10 synchronicity the police 12 piece of mind iron maiden 2 plans death cab for cutie 10 so peter gabriel 20
