function l1 l2 getmodematchlength q1 q2 f function l1 l2 getmodematchlength q1 q2 f this function returns the two lengths l1 and l2 needed to modematch the two beams q1 q2 with a single lens of focal length f q1 and q2 are purely imaginary parameters rad sqrt f 2 q1 q2 q1 2 q2 2 does a solution exist if f 2 abs q1 q2 l1 0 l2 0 fprintf no solution exists the minimum f is f mm n 1000 sqrt abs q1 q2 return end calculate the root taking the positive root l2 real f q2 f 2 q2 f q2 q1 q2 f q2 rad find l1 in terms of l2 l1 f q2 rad q2 that's all folks
